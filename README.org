#+AUTHOR: GTrunSec
#+EMAIL: gtrunsec@hardenedlinux.org
#+DATE: 10 August 2019
#+DESCRIPTION:
#+KEYWORDS:
#+LANGUAGE:  en cn
#+SETUPFILE: ~/org-notes/setup/darkcss.local
#+hugo_publishdate: (0 5)
#+hugo_auto_set_lastmod: t
#+HUGO_categories: 
#+HUGO_tags: 
#+OPTIONS:   H:3 num:t toc:t \n:nil @:t ::t |:t ^:t -:t f:t *:t <:t
#+SELECT_TAGS: export
#+EXCLUDE_TAGS: noexport
* CHANGES
- Quickly start
#+begin_src sh :tangle yes
    sudo pip install bro-pkg
    ##zeek installation is owned by "root" user that was stored in /root/.bro-pkg
    sudo zkg autoconfig
    sudo zkg config script_dir
    sudo zkg config plugin_dir
    sudo zkg install https://github.com/hardenedlinux/hardenedlinux-zeek-script

echo '@load packages' | sudo tee --append /usr/local/zeek/share/zeek/site/local.zeek

#or @load packages/hardenedlinux-zeek-script
sudo zeekctl deploy


#+end_src
- TEST Environment
#+begin_src shell :tangle yes
zeek -v
zeek version 3.0.0-rc1

zeekctl status
Name         Type    Host             Status    Pid    Started
manager      manager 10.220.170.123   running   9214   12 Aug 02:49:28
proxy-1      proxy   10.220.170.123   running   9264   12 Aug 02:49:29
worker-1     worker  10.220.170.121   running   1784   12 Aug 02:49:31
#+end_src
** VirusTotal-Check
- [X] [public]  [[file:scripts/files/known_hash.zeek]]
  - [X] [VT_API]  [[file:scripts/files/vt_check.zeek]]
  - [X] [POSTGRESQL]  [[file:scripts/files/virustotal.zeek]]

- [X] [TEST_LOG] [[file:scripts/files/log]]
 
Please see Install POSTGRESQL-analyzers:

[[https://github.com/hardenedlinux/Debian-GNU-Linux-Profiles/blob/master/NSM/INSTALL/analyzer.sh][Debian-GNU-Linux-Profiles/analyzer.sh at master · hardenedlinux/Debian-GNU-Linux-Profiles]]

** Known/hosts/domains
- [X] [[file:scripts/protocols/dns/known-domains.zeek]] :Cluster::worker <2019-08-10 Sat 02:36>
  - Test_log: [[file:scripts/protocols/dns/log/known_domain.log]]
- [X] [[file:scripts/protocols/dns/manager-domains.zeek]]  :Cluster::manager
    - [[file:scripts/protocols/dns/log/manager_known_domain.log]]
   - add TEST ignore_dns list 
- [X]  [[file:scripts/protocols/conn/known-hosts-with-dns.zeek]]
  - [[https://github.com/dopheide-esnet/zeek-known-hosts-with-dns/tree/master/scripts][zeek-known-hosts-with-dns/scripts at master · dopheide-esnet/zeek-known-hosts-with-dns]]
  - ~@unload protocols/conn/known-hosts~
  - setting/local_net_field.zeek  [Host_tracking = LOCAL_HOSTS/ALL_HOSTS]

** VXLAN
- [ ] [TODO] [[file:scripts/vlan-info/vlan-data.zeek][VLAN_INFO]] 
  - Add area and adapted to known-hosts[LOCAL_HOSTS]

